<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Passenger: Passenger::Application Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<b>Passenger</b>::<a class="el" href="classPassenger_1_1Application.html">Application</a></div>
<h1>Passenger::Application Class Reference<br>
<small>
[<a class="el" href="group__Support.html">Apache-independent support classes</a>]</small>
</h1><!-- doxytag: class="Passenger::Application" --><code>#include &lt;<a class="el" href="Application_8h-source.html">Application.h</a>&gt;</code>
<p>

<p>
<a href="classPassenger_1_1Application-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Represents a single Ruby on Rails application instance. <table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef function<br>
&lt; void(<a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a> <br>
&amp;session)&gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#a904ba56a6b0413f8da245a762cd681e">CloseCallback</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A type for callback functions that are called when a session is closed.  <a href="#a904ba56a6b0413f8da245a762cd681e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef shared_ptr<br>
&lt; <a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">SessionPtr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convenient alias for <a class="el" href="classPassenger_1_1Application_1_1Session.html" title="Represents the life time of a single request/response pair of a Ruby on Rails application...">Session</a> smart pointer.  <a href="#d14f673494991460b16246a527ad8ad9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#2504cb46b625c1b4c5344cae944b633d">Application</a> (const string &amp;theAppRoot, pid_t pid, int listenSocket)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a new <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails application instance.">Application</a> object.  <a href="#2504cb46b625c1b4c5344cae944b633d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#0a0665852e7ebc8fb8ab0772fa90bc56">getAppRoot</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the application root for this RoR application.  <a href="#0a0665852e7ebc8fb8ab0772fa90bc56"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="94d2cce1c2c1d3441325f1498a22bf02"></a><!-- doxytag: member="Passenger::Application::getPid" ref="94d2cce1c2c1d3441325f1498a22bf02" args="() const " -->
pid_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#94d2cce1c2c1d3441325f1498a22bf02">getPid</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the process ID of this application instance. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">SessionPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#2db08b6559ead2586f5c68f7bff0c188">connect</a> (const <a class="el" href="classPassenger_1_1Application.html#a904ba56a6b0413f8da245a762cd681e">CloseCallback</a> &amp;closeCallback) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connect to this application instance with the purpose of sending a request to the application.  <a href="#2db08b6559ead2586f5c68f7bff0c188"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6ddf2dcd2dd9993a8262c207d4154f2c"></a><!-- doxytag: member="Passenger::Application::getSessions" ref="6ddf2dcd2dd9993a8262c207d4154f2c" args="() const " -->
unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#6ddf2dcd2dd9993a8262c207d4154f2c">getSessions</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of currently opened sessions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">time_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#58e74f6a598dbc16d87ce0a1bf8da1d6">getLastUsed</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the last value set by <a class="el" href="classPassenger_1_1Application.html#f0cf4bbf3dd5f45a573c061bda643d86" title="Set the time at which this Application object was last used.">setLastUsed()</a>.  <a href="#58e74f6a598dbc16d87ce0a1bf8da1d6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application.html#f0cf4bbf3dd5f45a573c061bda643d86">setLastUsed</a> (time_t time)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the time at which this <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails application instance.">Application</a> object was last used.  <a href="#f0cf4bbf3dd5f45a573c061bda643d86"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents the life time of a single request/response pair of a Ruby on Rails application.  <a href="classPassenger_1_1Application_1_1Session.html#_details">More...</a><br></td></tr>
</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="a904ba56a6b0413f8da245a762cd681e"></a><!-- doxytag: member="Passenger::Application::CloseCallback" ref="a904ba56a6b0413f8da245a762cd681e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef function&lt;void (<a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a> &amp;session)&gt; <a class="el" href="classPassenger_1_1Application.html#a904ba56a6b0413f8da245a762cd681e">Passenger::Application::CloseCallback</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A type for callback functions that are called when a session is closed. 
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classPassenger_1_1Application.html#2db08b6559ead2586f5c68f7bff0c188" title="Connect to this application instance with the purpose of sending a request to the...">Application::connect()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="d14f673494991460b16246a527ad8ad9"></a><!-- doxytag: member="Passenger::Application::SessionPtr" ref="d14f673494991460b16246a527ad8ad9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef shared_ptr&lt;<a class="el" href="classPassenger_1_1Application_1_1Session.html">Session</a>&gt; <a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">Passenger::Application::SessionPtr</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convenient alias for <a class="el" href="classPassenger_1_1Application_1_1Session.html" title="Represents the life time of a single request/response pair of a Ruby on Rails application...">Session</a> smart pointer. 
<p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="2504cb46b625c1b4c5344cae944b633d"></a><!-- doxytag: member="Passenger::Application::Application" ref="2504cb46b625c1b4c5344cae944b633d" args="(const string &amp;theAppRoot, pid_t pid, int listenSocket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Passenger::Application::Application           </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>theAppRoot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&nbsp;</td>
          <td class="paramname"> <em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>listenSocket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Construct a new <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails application instance.">Application</a> object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>theAppRoot</em>&nbsp;</td><td>The application root of a RoR application, i.e. the folder that contains 'app/', 'public/', 'config/', etc. This must be a valid directory, but the path does not have to be absolute. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pid</em>&nbsp;</td><td>The process ID of this application instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>listenSocket</em>&nbsp;</td><td>The listener socket of this application instance. </td></tr>
  </table>
</dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd><a class="el" href="classPassenger_1_1Application.html#0a0665852e7ebc8fb8ab0772fa90bc56" title="Returns the application root for this RoR application.">getAppRoot()</a> == theAppRoot &amp;&amp; <a class="el" href="classPassenger_1_1Application.html#94d2cce1c2c1d3441325f1498a22bf02" title="Returns the process ID of this application instance.">getPid()</a> == pid </dd></dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="0a0665852e7ebc8fb8ab0772fa90bc56"></a><!-- doxytag: member="Passenger::Application::getAppRoot" ref="0a0665852e7ebc8fb8ab0772fa90bc56" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Passenger::Application::getAppRoot           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the application root for this RoR application. 
<p>
See the constructor for information about the application root. 
</div>
</div><p>
<a class="anchor" name="2db08b6559ead2586f5c68f7bff0c188"></a><!-- doxytag: member="Passenger::Application::connect" ref="2db08b6559ead2586f5c68f7bff0c188" args="(const CloseCallback &amp;closeCallback) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9">SessionPtr</a> Passenger::Application::connect           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPassenger_1_1Application.html#a904ba56a6b0413f8da245a762cd681e">CloseCallback</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>closeCallback</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Connect to this application instance with the purpose of sending a request to the application. 
<p>
Once connected, a new session will be opened. This session represents the life time of a single request/response pair, and can be used to send the request data to the application instance, as well as receiving the response data.<p>
The use of <a class="el" href="classPassenger_1_1Application.html#2db08b6559ead2586f5c68f7bff0c188" title="Connect to this application instance with the purpose of sending a request to the...">connect()</a> is demonstrated in the following example. <div class="fragment"><pre class="fragment">   <span class="comment">// Connect to the application and get the newly opened session.</span>
   <a class="code" href="classPassenger_1_1Application.html#d14f673494991460b16246a527ad8ad9" title="Convenient alias for Session smart pointer.">Application::SessionPtr</a> session(app-&gt;connect(<span class="stringliteral">"/home/webapps/foo"</span>));
   
   <span class="comment">// Send the request headers and request body data.</span>
   session-&gt;sendHeaders(...);
   session-&gt;sendBodyBlock(...);
   <span class="comment">// Done sending data, so we close the writer channel.</span>
   session-&gt;closeWriter();

   <span class="comment">// Now read the HTTP response.</span>
   <span class="keywordtype">string</span> responseData = readAllDataFromSocket(session-&gt;getReader());
   <span class="comment">// Done reading data, so we close the reader channel.</span>
   session-&gt;closeReader();

   <span class="comment">// This session has now finished, so we close the session by resetting</span>
   <span class="comment">// the smart pointer to NULL (thereby destroying the Session object).</span>
   session.reset();

   <span class="comment">// We can connect to an Application multiple times. Just make sure</span>
   <span class="comment">// the previous session is closed.</span>
   session = app-&gt;connect(<span class="stringliteral">"/home/webapps/bar"</span>)
</pre></div><p>
Note that a RoR application instance can only process one request at the same time, and thus only one session at the same time. You <b>must</b> close a session when you no longer need if. You you call <a class="el" href="classPassenger_1_1Application.html#2db08b6559ead2586f5c68f7bff0c188" title="Connect to this application instance with the purpose of sending a request to the...">connect()</a> without having properly closed a previous session, you might cause a deadlock because the application instance may be waiting for you to close the previous session.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A smart pointer to a <a class="el" href="classPassenger_1_1Application_1_1Session.html" title="Represents the life time of a single request/response pair of a Ruby on Rails application...">Session</a> object, which represents the created session. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>closeCallback</em>&nbsp;</td><td>A function which will be called when the session has been closed. </td></tr>
  </table>
</dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd>this-&gt;<a class="el" href="classPassenger_1_1Application.html#6ddf2dcd2dd9993a8262c207d4154f2c" title="Get the number of currently opened sessions.">getSessions()</a> == old-&gt;<a class="el" href="classPassenger_1_1Application.html#6ddf2dcd2dd9993a8262c207d4154f2c" title="Get the number of currently opened sessions.">getSessions()</a> + 1 </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classPassenger_1_1SystemException.html" title="Represents an error returned by a system call or a standard library call.">SystemException</a></em>&nbsp;</td><td>Something went wrong during the connection process. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classPassenger_1_1IOException.html" title="Represents an error that occured during an I/O operation.">IOException</a></em>&nbsp;</td><td>Something went wrong during the connection process. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="58e74f6a598dbc16d87ce0a1bf8da1d6"></a><!-- doxytag: member="Passenger::Application::getLastUsed" ref="58e74f6a598dbc16d87ce0a1bf8da1d6" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t Passenger::Application::getLastUsed           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the last value set by <a class="el" href="classPassenger_1_1Application.html#f0cf4bbf3dd5f45a573c061bda643d86" title="Set the time at which this Application object was last used.">setLastUsed()</a>. 
<p>
This represents the time at which this application object was last used.<p>
This is used by StandardApplicationPool's cleaner thread to determine which <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails application instance.">Application</a> objects have been idle for too long and need to be cleaned up. Thus, outside <a class="el" href="classPassenger_1_1StandardApplicationPool.html" title="A standard implementation of ApplicationPool for single-process environments.">StandardApplicationPool</a>, one should never have to call this method directly. 
</div>
</div><p>
<a class="anchor" name="f0cf4bbf3dd5f45a573c061bda643d86"></a><!-- doxytag: member="Passenger::Application::setLastUsed" ref="f0cf4bbf3dd5f45a573c061bda643d86" args="(time_t time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Passenger::Application::setLastUsed           </td>
          <td>(</td>
          <td class="paramtype">time_t&nbsp;</td>
          <td class="paramname"> <em>time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the time at which this <a class="el" href="classPassenger_1_1Application.html" title="Represents a single Ruby on Rails application instance.">Application</a> object was last used. 
<p>
See <a class="el" href="classPassenger_1_1Application.html#58e74f6a598dbc16d87ce0a1bf8da1d6" title="Returns the last value set by setLastUsed().">getLastUsed()</a> for information.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>The time. </td></tr>
  </table>
</dl>
<dl class="post" compact><dt><b>Postcondition:</b></dt><dd><a class="el" href="classPassenger_1_1Application.html#58e74f6a598dbc16d87ce0a1bf8da1d6" title="Returns the last value set by setLastUsed().">getLastUsed()</a> == time </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="Application_8h-source.html">Application.h</a></ul>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 8 20:08:49 2008 for Passenger by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
